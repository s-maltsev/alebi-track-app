[{"name":"/SessionList","nodes":[{"id":"5beb56d4-9274-cab1-1895-0eac4ac248d8","type":"Page","parameters":{"styleCss":"background-color: black;"},"ports":[],"children":[{"id":"9f11f0cb-96a2-ce40-b151-ca0663d19348","type":"net.noodl.controls.button","parameters":{"label":"Добавить тренировку","alignX":"center","marginTop":{"value":20,"unit":"px"},"marginBottom":{"value":20,"unit":"px"},"backgroundColor":"Alebi - red","sizeMode":"explicit","width":{"value":90,"unit":"%"},"borderRadius":{"value":5,"unit":"px"}},"ports":[],"children":[]},{"id":"d415cbf5-b8f1-74d3-0147-613511b3c1cc","type":"Group","parameters":{},"ports":[],"children":[{"id":"46023f4c-e9e6-a3b8-da0f-8837f51a26ab","type":"Group","parameters":{"scrollEnabled":true,"nativeScroll":false,"showScrollbar":false,"scrollBounceEnabled":false,"scrollSnapEnabled":false,"position":"absolute","flexWrap":"nowrap","height":{"value":100,"unit":"%"},"sizeMode":"explicit","clip":true},"ports":[],"children":[{"id":"f7b0f4e1-871d-d92c-29c5-8b4a11a0e320","type":"For Each","parameters":{"template":"/Card Session","inputMappingScript":"// Here you add mappings between the properties of the item objects and the inputs of the components.\n// 'myComponentInput': 'myObjectProperty',\n// 'anotherComponentInput': function () { return object.get('someProperty') + ' ' + object.get('otherProp') }\n// These are the default mappings based on the selected template component.\nmap({\n\t'Title': 'name',\n\t'Stage': 'stage',\n\t'Date': 'date',\n})\n"},"ports":[],"children":[]}]}]}]},{"id":"1275c788-8927-a835-bd09-8b1ad571f529","type":"Model2","parameters":{},"ports":[],"children":[]},{"id":"b75d3e70-c7d9-29e0-5918-3cf5ef88cd83","type":"DbCollection2","parameters":{"collectionName":"Sessions","storageEnableCount":false,"visualSort":[{"property":"date","order":"descending"}]},"ports":[],"children":[]},{"id":"f1cb2bc1-e971-65a3-2747-dd1b6066173a","type":"RouterNavigate","parameters":{"router":"Main","target":"/SessionDetails"},"ports":[],"children":[]},{"id":"84e5871e-4e85-3303-e674-37ed0c461287","type":"NavigationShowPopup","parameters":{"target":"/AddSession"},"ports":[],"children":[]},{"id":"25d6f36d-fb0c-bfd5-8237-dd699eb813ff","type":"NewDbModelProperties","parameters":{"collectionName":"Sessions","prop-stage":"Planned","prop-name":"Кросс-биатлон"},"ports":[],"children":[]}],"connections":[{"sourceId":"f7b0f4e1-871d-d92c-29c5-8b4a11a0e320","sourcePort":"itemActionItemId","targetId":"1275c788-8927-a835-bd09-8b1ad571f529","targetPort":"modelId"},{"sourceId":"f7b0f4e1-871d-d92c-29c5-8b4a11a0e320","sourcePort":"itemOutputSignal-Clicked","targetId":"1275c788-8927-a835-bd09-8b1ad571f529","targetPort":"fetch"},{"sourceId":"b75d3e70-c7d9-29e0-5918-3cf5ef88cd83","sourcePort":"items","targetId":"f7b0f4e1-871d-d92c-29c5-8b4a11a0e320","targetPort":"items"},{"sourceId":"f7b0f4e1-871d-d92c-29c5-8b4a11a0e320","sourcePort":"itemOutputSignal-Clicked","targetId":"f1cb2bc1-e971-65a3-2747-dd1b6066173a","targetPort":"navigate"},{"sourceId":"f7b0f4e1-871d-d92c-29c5-8b4a11a0e320","sourcePort":"itemActionItemId","targetId":"f1cb2bc1-e971-65a3-2747-dd1b6066173a","targetPort":"pm-SessionID"},{"sourceId":"9f11f0cb-96a2-ce40-b151-ca0663d19348","sourcePort":"onClick","targetId":"84e5871e-4e85-3303-e674-37ed0c461287","targetPort":"show"},{"sourceId":"84e5871e-4e85-3303-e674-37ed0c461287","sourcePort":"closeAction-Save","targetId":"25d6f36d-fb0c-bfd5-8237-dd699eb813ff","targetPort":"store"},{"sourceId":"84e5871e-4e85-3303-e674-37ed0c461287","sourcePort":"closeResult-date","targetId":"25d6f36d-fb0c-bfd5-8237-dd699eb813ff","targetPort":"prop-date"},{"sourceId":"84e5871e-4e85-3303-e674-37ed0c461287","sourcePort":"closeResult-location","targetId":"25d6f36d-fb0c-bfd5-8237-dd699eb813ff","targetPort":"prop-location"}],"ports":[],"roots":["5beb56d4-9274-cab1-1895-0eac4ac248d8"],"metadata":{"canvasPos":{"x":2029,"y":0}}},{"name":"/Card Session","nodes":[{"id":"3e66709d-ea93-29f4-87c6-bdea37c996ee","type":"Group","parameters":{"backgroundColor":"transparent","paddingTop":{"value":15,"unit":"px"},"paddingLeft":{"value":20,"unit":"px"},"paddingBottom":{"value":15,"unit":"px"},"paddingRight":{"value":20,"unit":"px"},"borderRadius":{"value":4,"unit":"px"},"sizeMode":"contentSize","flexDirection":"row","alignItems":"center","boxShadowEnabled":false,"boxShadowSpreadRadius":{"value":0,"unit":"px"},"boxShadowOffsetY":{"value":3,"unit":"px"},"boxShadowColor":"#3B177526","boxShadowBlurRadius":{"value":4,"unit":"px"},"styleCss":"cursor:pointer;","marginBottom":{"value":0,"unit":"px"},"alignX":"left","scrollEnabled":true,"marginLeft":{"value":0,"unit":"px"},"marginRight":{"value":0,"unit":"px"},"marginTop":{"value":0,"unit":"px"},"clip":false,"nativeScroll":false,"scrollSnapEnabled":true},"stateParameters":{"hover":{}},"ports":[],"children":[{"id":"1fe599e7-4f2d-dd22-fff2-fc0ee9f08867","type":"Group","parameters":{"flexDirection":"row","width":{"value":90,"unit":"vw"},"borderRadius":{"value":4,"unit":"px"},"paddingLeft":{"value":10,"unit":"px"},"paddingTop":{"value":5,"unit":"px"},"paddingBottom":{"value":5,"unit":"px"},"paddingRight":{"value":10,"unit":"px"}},"ports":[],"children":[{"id":"019b556a-576e-bb40-5abe-cb59848ee0d0","type":"Group","parameters":{"sizeMode":"contentHeight","width":{"value":60,"unit":"%"}},"ports":[],"children":[{"id":"aecd376c-db71-fba3-1822-48dd534dfcd5","type":"Group","parameters":{},"ports":[],"children":[{"id":"d9e768eb-2584-3bce-2d83-3b93ae1f1a02","type":"Text","parameters":{"textStyle":"Title Medium","text":"Client meeting"},"ports":[],"children":[]},{"id":"3d1f7f4c-3f78-8504-cd61-8552fb095500","type":"Text","parameters":{"textStyle":"Label Large","color":"Grey - 700","text":"Work"},"ports":[],"children":[]},{"id":"b7fc739d-61ed-67f4-dcef-811d213c73f8","type":"Text","parameters":{"textStyle":"Label Large","color":"Grey - 900","text":"Jan 10","alignY":"bottom","marginTop":{"value":16,"unit":"px"}},"ports":[],"children":[]}]}]},{"id":"394d8ac9-6769-9ace-5c7e-98a966ab611d","type":"Group","parameters":{"flexDirection":"column","sizeMode":"contentHeight","height":{"value":100,"unit":"%"},"width":{"value":40,"unit":"%"}},"ports":[],"children":[{"id":"4a625c47-f6fb-6d07-8c79-19dcbc3f82a4","type":"Group","parameters":{"flexDirection":"row","sizeMode":"explicit","alignX":"center"},"ports":[],"children":[{"id":"afb6a59e-543d-1e77-84c6-fb4a5607c50b","type":"Text","parameters":{"text":"🏃‍➡️","fontSize":{"value":24,"unit":"px"},"textAlignX":"center","width":{"value":20,"unit":"%"}},"ports":[],"children":[]},{"id":"c514b6db-540a-a7ce-6bdd-0d38a06c603f","type":"Text","parameters":{"fontSize":{"value":22,"unit":"px"},"textAlignX":"center"},"ports":[],"children":[]}]},{"id":"707e53a1-acde-f451-3ad8-d1fd92b458ec","type":"Group","parameters":{"flexDirection":"row","sizeMode":"explicit","alignX":"right"},"ports":[],"children":[{"id":"557974b2-b31e-1362-3fa7-ad3e6965ebf4","type":"Text","parameters":{"text":"🎯","fontSize":{"value":24,"unit":"px"},"textAlignX":"right","width":{"value":20,"unit":"%"}},"ports":[],"children":[]},{"id":"290f5a88-c4b0-8fc3-9c06-8dd8d35ecca0","type":"Text","parameters":{"fontSize":{"value":16,"unit":"px"},"textAlignX":"center","wordBreak":"break-all","alignY":"center"},"ports":[],"children":[]}]}]}]},{"id":"3c2f2231-8aa6-069f-856b-eff8b40e9c80","type":"Group","parameters":{"width":{"value":10,"unit":"vw"}},"ports":[],"children":[{"id":"3681efaf-2c57-733e-d6dd-3dc13b5dbcaa","type":"net.noodl.controls.button","parameters":{"sizeMode":"explicit","height":{"value":100,"unit":"%"}},"ports":[],"children":[]}]}]},{"id":"1ce0ef6a-baf9-534f-20b1-cde9ed1bf3b2","type":"Component Outputs","parameters":{},"ports":[],"children":[]},{"id":"9c6e933b-b8b7-25eb-69b6-c95e69a860ee","type":"States","parameters":{"states":"Active,Finished,Planned","values":"Background Color","transition-Finished-Green":{"curve":[0.42,0,1,1],"dur":300,"delay":0},"useTransitions":false,"type-Background Color":"color","value-Active-Background Color":"Success","value-Finished-Background Color":"Grey - 600","value-Planned-Background Color":"White","type-ReadOnly":"boolean","value-Finished-ReadOnly":true,"value-Planned-ReadOnly":true},"ports":[],"children":[]},{"id":"e516779e-36db-ec2f-ef8b-65afbd7ee455","type":"Date To String","parameters":{"formatString":"{date}-{month}-{year} {hours}-{minutes}"},"ports":[],"children":[]},{"id":"66a3bbff-af3f-4963-0e6a-b0a916df37c4","type":"DbCollection2","parameters":{"collectionName":"Participants","visualFilter":{"combinator":"or","rules":[{"combinator":"and","rules":[{"property":"session","operator":"points to","input":"currentSession"}]}]}},"ports":[],"children":[]},{"id":"7df0712b-32be-1a2c-5803-701d878f4592","type":"DbModel2","parameters":{"idSource":"foreach","collectionName":"Sessions"},"ports":[],"children":[]},{"id":"31323031-f983-997a-1e0d-05b3c9ca6693","type":"DbCollection2","parameters":{"collectionName":"Exercises","visualFilter":{"combinator":"or","rules":[{"combinator":"and","rules":[{"property":"session","operator":"points to","input":"MyRecordId"}]}]},"storageFilterType":"json","storageJSONFilter":"// Write your query script here, check out the reference documentation for examples\nconst participants = Array.isArray(Inputs.currentParticipants)?Inputs.currentParticipants:[];\nconsole.log(\"Участники (\",participants.count,\"): \",participants.map(a => a.id));\nwhere({\n  participant: { containedIn: participants.map(a => a.id) },\n});"},"ports":[],"children":[]},{"id":"25617702-44d1-004c-7904-fded7b0c7ab4","type":"DbCollection2","parameters":{"collectionName":"Results","storageFilterType":"json","storageJSONFilter":"// Write your query script here, check out the reference documentation for examples\nconst exercises = Array.isArray(Inputs.participantExercise)?Inputs.participantExercise:[];\nconsole.log(\"Упражнения (\",exercises.count,\"): \",exercises.map(a => a.id));\nwhere({\n  exercise: { containedIn: exercises.map(a=>a.id) },\n});"},"ports":[],"children":[]},{"id":"2eafb4d5-e0e2-6937-c515-46dd8cc1f078","type":"JavaScriptFunction","parameters":{"functionScript":"let scores = Inputs.scores;\r\n\r\nconst lay = scores.filter(a => a.prone == true);\r\nconst scores_lay = lay.map(a => a.score);\r\nconst stay = scores.filter(a => a.prone == false);\r\nconst scores_stay = stay.map(a => a.score);\r\n\r\nconst sum_lay = scores_lay.reduce((accumulator, currentValue) => accumulator + currentValue, 0);\r\nconst sum_stay = scores_stay.reduce((accumulator, currentValue) => accumulator + currentValue, 0);\r\n\r\nconst result_lay = 100-((sum_lay / (scores_lay.length*5))*100).toFixed(0);\r\nconst result_stay = 100-((sum_lay / (scores_stay.length*5))*100).toFixed(0);\r\n\r\n\r\n\r\nOutputs.result_lay = result_lay;\r\nOutputs.result_stay = result_stay;","scriptInputs":[{"id":"ji74","label":"scores"}],"intype-scores_lay":"array","intype-scores_stay":"array","scriptOutputs":[{"id":"3zqc","label":"result_lay"},{"id":"d7df","label":"result_stay"}],"outtype-result_lay":"string","outtype-result_stay":"string","intype-scores":"array"},"ports":[{"name":"outtype-result_lay","displayName":"Type","editorName":"result_lay | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"},{"value":"signal","label":"Signal"}],"allowEditOnly":true},"default":"string","parent":"scriptOutputs","parentItemId":"3zqc","index":4},{"name":"out-result_lay","displayName":"result_lay","plug":"output","type":"string","group":"Outputs","index":5},{"name":"outtype-result_stay","displayName":"Type","editorName":"result_stay | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"},{"value":"signal","label":"Signal"}],"allowEditOnly":true},"default":"string","parent":"scriptOutputs","parentItemId":"d7df","index":6},{"name":"out-result_stay","displayName":"result_stay","plug":"output","type":"string","group":"Outputs","index":7},{"name":"intype-scores","displayName":"Type","editorName":"scores | Type","plug":"input","type":{"name":"enum","enums":[{"value":"string","label":"String"},{"value":"boolean","label":"Boolean"},{"value":"number","label":"Number"},{"value":"object","label":"Object"},{"value":"date","label":"Date"},{"value":"array","label":"Array"},{"value":"color","label":"Color"}],"allowEditOnly":true},"default":"string","parent":"scriptInputs","parentItemId":"ji74","index":8},{"name":"in-scores","displayName":"scores","plug":"input","type":"array","group":"Inputs","index":9}],"children":[]},{"id":"9bf9235c-243b-1c54-bd6b-3d637e38a049","type":"String Format","parameters":{"format":"{result_lay}  / {result_stay}"},"ports":[],"children":[]}],"connections":[{"sourceId":"e516779e-36db-ec2f-ef8b-65afbd7ee455","sourcePort":"currentValue","targetId":"b7fc739d-61ed-67f4-dcef-811d213c73f8","targetPort":"text"},{"sourceId":"66a3bbff-af3f-4963-0e6a-b0a916df37c4","sourcePort":"count","targetId":"c514b6db-540a-a7ce-6bdd-0d38a06c603f","targetPort":"text"},{"sourceId":"7df0712b-32be-1a2c-5803-701d878f4592","sourcePort":"prop-date","targetId":"e516779e-36db-ec2f-ef8b-65afbd7ee455","targetPort":"input"},{"sourceId":"7df0712b-32be-1a2c-5803-701d878f4592","sourcePort":"prop-stage","targetId":"9c6e933b-b8b7-25eb-69b6-c95e69a860ee","targetPort":"currentState"},{"sourceId":"7df0712b-32be-1a2c-5803-701d878f4592","sourcePort":"prop-name","targetId":"d9e768eb-2584-3bce-2d83-3b93ae1f1a02","targetPort":"text"},{"sourceId":"25617702-44d1-004c-7904-fded7b0c7ab4","sourcePort":"items","targetId":"2eafb4d5-e0e2-6937-c515-46dd8cc1f078","targetPort":"in-scores"},{"sourceId":"9bf9235c-243b-1c54-bd6b-3d637e38a049","sourcePort":"formatted","targetId":"290f5a88-c4b0-8fc3-9c06-8dd8d35ecca0","targetPort":"text"},{"sourceId":"25617702-44d1-004c-7904-fded7b0c7ab4","sourcePort":"fetched","targetId":"2eafb4d5-e0e2-6937-c515-46dd8cc1f078","targetPort":"run"},{"sourceId":"2eafb4d5-e0e2-6937-c515-46dd8cc1f078","sourcePort":"out-result_lay","targetId":"9bf9235c-243b-1c54-bd6b-3d637e38a049","targetPort":"result_lay"},{"sourceId":"2eafb4d5-e0e2-6937-c515-46dd8cc1f078","sourcePort":"out-result_stay","targetId":"9bf9235c-243b-1c54-bd6b-3d637e38a049","targetPort":"result_stay"},{"sourceId":"9c6e933b-b8b7-25eb-69b6-c95e69a860ee","sourcePort":"Background Color","targetId":"1fe599e7-4f2d-dd22-fff2-fc0ee9f08867","targetPort":"backgroundColor"},{"sourceId":"1fe599e7-4f2d-dd22-fff2-fc0ee9f08867","sourcePort":"onClick","targetId":"1ce0ef6a-baf9-534f-20b1-cde9ed1bf3b2","targetPort":"Clicked"},{"sourceId":"7df0712b-32be-1a2c-5803-701d878f4592","sourcePort":"id","targetId":"66a3bbff-af3f-4963-0e6a-b0a916df37c4","targetPort":"qp-currentSession"},{"sourceId":"66a3bbff-af3f-4963-0e6a-b0a916df37c4","sourcePort":"items","targetId":"31323031-f983-997a-1e0d-05b3c9ca6693","targetPort":"storageFilterValue-currentParticipants"},{"sourceId":"7df0712b-32be-1a2c-5803-701d878f4592","sourcePort":"fetched","targetId":"66a3bbff-af3f-4963-0e6a-b0a916df37c4","targetPort":"storageFetch"},{"sourceId":"66a3bbff-af3f-4963-0e6a-b0a916df37c4","sourcePort":"fetched","targetId":"31323031-f983-997a-1e0d-05b3c9ca6693","targetPort":"storageFetch"},{"sourceId":"31323031-f983-997a-1e0d-05b3c9ca6693","sourcePort":"fetched","targetId":"25617702-44d1-004c-7904-fded7b0c7ab4","targetPort":"storageFetch"},{"sourceId":"31323031-f983-997a-1e0d-05b3c9ca6693","sourcePort":"items","targetId":"25617702-44d1-004c-7904-fded7b0c7ab4","targetPort":"storageFilterValue-participantExercise"},{"sourceId":"7df0712b-32be-1a2c-5803-701d878f4592","sourcePort":"prop-stage","targetId":"3d1f7f4c-3f78-8504-cd61-8552fb095500","targetPort":"text"}],"ports":[{"name":"Clicked","type":"signal","plug":"output","index":1},{"name":"ReadOnly","type":"*","plug":"output","index":2}],"roots":["3e66709d-ea93-29f4-87c6-bdea37c996ee"]}]